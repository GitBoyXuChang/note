## 钉钉小程序官方文档

### 框架

#### 概述

更新时间: 2019-6-3

##### 文件结构

小程序分为 `app` 和 `page` 两层。`app` 用来描述整体程序，`page` 用来描述各个页面。

`app` 由三个文件组成，必须放在项目的根目录。

| 文件     | 必填 | 作用             |
| -------- | ---- | ---------------- |
| app.js   | 是   | 小程序逻辑       |
| app.json | 是   | 小程序公共设置   |
| app.acss | 否   | 小程序公共样式表 |

`page` 由四个文件组成，分别是：

| 文件类型 | 必填 | 作用       |
| -------- | ---- | ---------- |
| js       | 是   | 页面逻辑   |
| axml     | 是   | 页面结构   |
| acss     | 否   | 页面样式表 |
| json     | 否   | 页面配置   |

注意：为了方便开发者，我们规定这四个文件必须具有相同的路径与文件名。

开发者写的所有代码最终将会打包成一份 JavaScript 脚本，在小程序启动的时候运行，在小程序结束运行时销毁。

##### 逻辑结构

小程序的核心是一个响应式的数据绑定系统，逻辑上分为视图层和逻辑层。这两层始终保持同步，只要在逻辑层修改数据，视图层就会相应的更新。

请看下面这个简单的例子。

```html
<!-- 视图层 -->
<view> Hello {{name}}! </view>
<button onTap="changeName"> Click me! </button>
<!-- 逻辑层 -->
var initialData = {
  name: 'alibaba'
};

// Register a Page.
Page({
  data: initialData,
  changeName(e) {
    // sent data change to view
    this.setData({
      name: 'dingtalk'
    })
  }
});
```

上面代码中，框架自动将逻辑层数据中的`name`与视图层的`name`进行了绑定，所以在页面一打开的时候会显示`Hello alibaba!`。

用户点击按钮的时候，视图层会发送`changeName`的事件给逻辑层，逻辑层找到对应的事件处理函数。逻辑层执行了`setData`的操作，将`name`从`alibaba`变为`dingtalk`，因为该数据和视图层已经绑定了，从而视图层会自动改变为`Hello dingtalk!`。

注意：由于框架并非运行在浏览器中，所以 JavaScript 在 web 中的一些能力都无法使用，如 `document`、`window`等对象。

逻辑层 js 可以用 es2015 模块化语法组织代码：

```js
import util from './util'; // 载入相对路径
import absolute from '/absolute'; // 载入项目根路径文件
```

##### 第三方NPM模块

小程序支持引入第三方模块，需先在小程序根目录下执行如下命令安装该模块:

```js
npm install lodash
```

引入后即可在逻辑层中直接使用：

```js
import lodash from 'lodash'; // 载入第三方 npm 模块
```

注意：由于 node_modules 里第三方模块代码不会经过转换器，为了确保各个终端兼容，node_modules 下的代码需要转成 es5 格式再引用，模块格式推荐使用 es2015 的 import/export。同时，浏览器相关web能力同样无法使用。

#### App

更新时间: 2019-6-3

##### 简介

`App`代表顶层应用，管理所有页面和全局数据，以及提供生命周期方法。它也是一个构造方法，生成`App`实例。一个小程序就是一个`App`实例。

每个小程序的顶层一般包含三个文件。

- app.js：应用逻辑
- app.acss：应用样式（可选）
- app.json：应用配置

下面是一个简单的 `app.json`。

```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/index"
  ],
  "window": {
    "defaultTitle": "Demo"
  }
}
```

上面配置指定小程序包含两个页面，以及应用窗口的默认标题是 `Demo`。

`App` 提供四个事件，可以设置钩子方法。

- onLaunch：小程序启动
- onShow：小程序切换到前台
- onHide：小程序切换到后台
- onError: 小程序出错

一个简单的`app.js`代码如下。

```javascript
App({
  onLaunch(options) {
    // 初始化
  },
  onShow(options) {
    // 显示
  },
  onHide() {
    // 隐藏
  },
  onError(msg) {
    console.log(msg)
  },
  globalData: {
    foo: true,
  }
})
```

##### App()

`App()` 接受一个 `object` 作为参数，用来配置小程序的生命周期等。

参数说明：

| 属性     | 类型     | 描述             | 触发时机                                 |
| :------- | :------- | :--------------- | :--------------------------------------- |
| onLaunch | Function | 监听小程序初始化 | 当小程序初始化完成时触发，全局只触发一次 |
| onShow   | Function | 监听小程序显示   | 当小程序启动，或从后台进入前台显示时触发 |
| onHide   | Function | 监听小程序隐藏   | 当小程序从前台进入后台时触发             |
| onError  | Function | 监听小程序错误   | 当小程序发生 js 错误时触发               |

**前台、后台定义**： 用户点击左上角关闭，或者按了设备 Home 键离开钉钉时，小程序并不会直接销毁，而是进入了后台，当再次进入钉钉或再次打开小程序时，又会从后台进入前台。

只有当小程序进入后台一定时间，或占用系统资源过高，才会被真正销毁。

##### onLaunch/onShow 方法的参数

| 属性  | 类型   | 描述                 |
| :---- | :----- | :------------------- |
| query | Object | 当前小程序的 query   |
| path  | String | 当前小程序的页面地址 |

注意 query 从启动参数的 query 字段解析而来，path 从启动参数 page 字段解析而来。例如 url 如下：

```
dingtalk://dingtalkclient/action/open_mini_app?miniAppId=1999&query=number%3D1&page=x%2Fy%2Fz
```

其中的`query`参数解析如下：

```
number%3D1 === encodeURIComponent('number=1')
```

其中的`path`参数解析如下：

```
x%2Fy%2Fz === encodeURIComponent('x/y/z')
```

page 忽略时默认为首页。

那么，当用户第一次启动小程序可以从 `onLaunch` 方法中获取这个参数，或者小程序在后台时被重新用 scheme 打开也可以从 `onShow` 方法中获取这个参数。

```js
App({
  onLaunch(options) {
    // 第一次打开
    // options.query == {number:1}
  },
  onShow(options) {
    // 从后台被 scheme 重新打开
	// options.query == {number:1}
  },
})
```

> 备注：非第三方个人应用类型，如企业内部应用、第三方企业应用在启动时，options.query中会自动包含企业的corpId

##### getApp()

我们提供了全局的`getApp()`函数，可以获取到小程序实例，一般用在各个子页面之中获取顶层应用。

```javascript
var app = getApp()
console.log(app.globalData) // 获取 globalData
```

注意：

- `App()`必须在 `app.js` 里调用，且不能调用多次。
- 不要在 `App()` 内定义的函数中调用 `getApp()`，使用 `this` 就可以拿到 `app` 实例。
- 不要在 `onLaunch` 里调用[`getCurrentPages()`](https://open-doc.dingtalk.com/microapp/dev/framework-page#getcurrentpages)，这个时候 `page` 还没有生成。
- 通过 `getApp()` 获取实例之后，不要私自调用生命周期函数。

全局的数据可以在 App() 中设置，各个子页面通过全局函数 getApp() 可以获取全局的应用实例。下面是一个例子。

```js
// app.js
App({
  globalData: 1
})
// a.js

// localValue 只在 a.js 有效
var localValue = 'a'

// 生成 app 实例
var app = getApp()

// 拿到全局数据，并改变它
app.globalData++
// b.js

// localValue 只在 b.js 有效
var localValue = 'b'

// 如果 a.js 先运行，globalData 会返回 2
console.log(getApp().globalData)
```

上面代码中，`a.js`和`b.js`都声明了变量`localValue`，它们不会互相影响，因为各个脚本声明的变量和函数只在该文件中有效。

##### app.json

`app.json`用于全局配置，决定页面文件的路径、窗口表现、设置网络超时时间、设置多 tab 等。

以下是一个包含了部分配置选项的简单配置`app.json`。

```json
{
  "pages": [
    "pages/index/index",
    "pages/logs/index"
  ],
  "window": {
    "defaultTitle": "Demo"
  }
}
```

`app.json`配置项如下。

| 文件   | 类型         | 必填 | 描述                   |
| :----- | :----------- | :--- | :--------------------- |
| pages  | String Array | 是   | 设置页面路径           |
| window | Object       | 否   | 设置默认页面的窗口表现 |
| tabBar | Object       | 否   | 设置底部 tab 的表现    |

**（1）pages**

`pages`属性是一个数组，每一项都是字符串，用来指定小程序的页面。每一项代表对应页面的路径信息，数组的第一项代表小程序的首页。小程序中新增/减少页面，都需要对 `pages`数组进行修改。

页面路径不需要写 `js` 后缀，框架会自动去加载同名的`.json`、`.js`、`.axml`、`.acss`文件。

举例来说，如果开发目录为：

```
pages/
pages/index/index.axml
pages/index/index.js
pages/index/index.acss
pages/logs/logs.axml
pages/logs/logs.js
app.js
app.json
app.acss
```

`app.json`就要写成下面的样子。

```json
{
  "pages":[
    "pages/index/index",
    "pages/logs/logs"
  ]
}
```

**（2）window**

`window`属性用于设置通用的的状态栏、导航条、标题、窗口背景色。

子属性包括 `titleBarColor` `defaultTitle` `pullRefresh` `allowsBounceVertical`。

| 文件                 | 类型           | 必填 | 描述                                       |
| :------------------- | :------------- | :--- | :----------------------------------------- |
| titleBarColor        | HexColor       | 否   | 导航栏背景色                               |
| defaultTitle         | String         | 否   | 页面标题                                   |
| pullRefresh          | Boolean        | 否   | 是否允许下拉刷新。默认 false               |
| allowsBounceVertical | String(YES/NO) | 否   | 页面是否支持纵向拽拉超出实际内容。默认 YES |

下面是一个例子。

```json
{
  "window":{
    "defaultTitle": "钉钉接口功能演示"
  }
}
```

**（3）tabBar**

如果你的小程序是一个多 tab 应用（客户端窗口的底部栏可以切换页面），那么可以通过`tabBar`配置项指定 tab 栏的表现，以及 tab 切换时显示的对应页面。

注意，通过页面跳转（`dd.navigateTo`）或者页面重定向（`dd.redirectTo`）所到达的页面，即使它是定义在 tabBar 配置中的页面，也不会显示底部的 tab 栏。另外，`tabBar` 的第一个页面必须是首页。

tabBar 配置

| 文件            | 类型     | 必填 | 描述          |
| :-------------- | :------- | :--- | :------------ |
| textColor       | HexColor | 否   | 文字颜色      |
| selectedColor   | HexColor | 否   | 选中文字颜色  |
| backgroundColor | HexColor | 否   | 背景色        |
| items           | Array    | 是   | 每个 tab 配置 |

每个 item 配置

| 文件       | 类型   | 必填 | 描述         |
| :--------- | :----- | :--- | :----------- |
| pagePath   | String | 是   | 设置页面路径 |
| name       | String | 是   | 名称         |
| icon       | String | 否   | 平常图标路径 |
| activeIcon | String | 否   | 高亮图标路径 |

icon 推荐大小为 60*60px 大小，系统会对任意传入的图片非等比拉伸/缩放。

例如

```json
{
  "tabBar": {
    "textColor": "#dddddd",
    "selectedColor": "#49a9ee",
    "backgroundColor": "#ffffff",
    "items": [
      {
        "pagePath": "pages/index/index",
        "name": "首页"
      },
      {
        "pagePath": "pages/logs/logs",
        "name": "日志"
      }
    ]
  }
}
```

#### Page

更新时间: 2018-10-26

##### 简介

`Page`代表应用的一个页面，负责页面展示和交互。每个页面对应一个子目录，一般有多少个页面，就有多少个子目录。它也是一个构造函数，用来生成页面实例。

页面初始化时，需要提供数据作为页面的第一次渲染。

```html
<view>{{title}}</view>
<view>{{array[0].user}}</view>
Page({
  data: {
    title: 'Dingtalk',
    array: [{user: 'li'}, {user: 'zhao'}]
  }
})
```

定义交互行为时，需要在页面脚本里面指定响应函数。

```html
<view onTap="handleTap">click me</view>
```

上面模板定义用户点击时，调用 `handleTap` 方法。

```javascript
Page({
  handleTap() {
    console.log('yo! view tap!')
  }
})
```

页面重新渲染，需要在页面脚本里面调用`this.setData`方法。

```html
<view>{{text}}</view>
<button onTap="changeText"> Change normal data </button>
```

上面代码指定用户触摸按钮时，调用`changeText`方法。

```javascript
Page({
  data: {
    text: 'init data',
  },
  changeText() {
    this.setData({
      text: 'changed data'
    })
  },
})
```

上面代码中，`changeText`方法里面调用`this.setData`方法，会导致页面的重新渲染。

##### Page()

`Page()` 接受一个 `object` 作为参数，该参数用来指定页面的初始数据、生命周期函数、事件处理函数等。

```js
//index.js
Page({
  data: {
    title: "Dingtalk"
  },
  onLoad(query) {
    // 页面加载
  },
  onReady() {
    // 页面加载完成
  },
  onShow() {
    // 页面显示
  },
  onHide() {
    // 页面隐藏
  },
  onUnload() {
    // 页面被关闭
  },
  onTitleClick() {
    // 标题被点击
  },
  onPullDownRefresh() {
    // 页面被下拉
  },
  onReachBottom() {
    // 页面被拉到底部
  },
  onShareAppMessage() {
   // 返回自定义分享信息
  },
  viewTap() {
    // 事件处理
    this.setData({
      text: 'Set data for update.'
    })
  },
  go() {
    // 带参数的跳转，从 page/index 的 onLoad 函数的 query 中读取 xx
    dd.navigateTo({url:'/page/index?xx=1'})
  },
  customData: {
    hi: 'Dingtalk'
  }
})
```

上面代码中，`Page()`方法的参数对象说明如下。

| 属性              | 类型                    | 描述                                                         |
| :---------------- | :---------------------- | :----------------------------------------------------------- |
| data              | Object or Function      | 初始数据或返回初始化数据的函数                               |
| onTitleClick      | Function                | 点击标题触发                                                 |
| onPageScroll      | Function({scrollTop})   | 页面滚动时触发                                               |
| onLoad            | Function(query: Object) | 页面加载时触发                                               |
| onReady           | Function                | 页面初次渲染完成时触发                                       |
| onShow            | Function                | 页面显示时触发                                               |
| onHide            | Function                | 页面隐藏时触发                                               |
| onUnload          | Function                | 页面卸载时触发                                               |
| onPullDownRefresh | Function                | 页面下拉时触发                                               |
| onReachBottom     | Function                | 上拉触底时触发                                               |
| onShareAppMessage | Function                | 点击右上角分享时触发                                         |
| 其他              | Any                     | 开发者可以添加任意的函数或属性到 `object` 参数中，在页面的函数中可以用 `this` 来访问 |

**注意**：data 为对象时，如果你在页面中修改 data 则会影响该页面的不同实例。

**（1）生命周期方法的说明**

- onLoad: 页面加载。一个页面只会调用一次，query 参数为 `dd.navigateTo` 和 `dd.redirectTo` 中传递的 `query` 对象。
- onShow: 页面显示。每次页面显示都会调用一次。
- onReady: 页面初次渲染完成。一个页面只会调用一次，代表页面已经准备妥当，可以和视图层进行交互。对界面的设置，如 `dd.setNavigationBar` 请在 `onReady` 之后设置。
- onHide: 页面隐藏。当 `dd.navigateTo` 到其他页面或底部 `tab` 切换时调用。
- onUnload: 页面卸载。当 `dd.redirectTo` 或 `dd.navigateBack` 到其他页面的时候调用。

**（2）事件处理函数的说明**

- onPullDownRefresh: 下拉刷新。监听用户下拉刷新事件，需要在 `app.json` 的 `window` 选项中开启`pullRefresh`，当处理完数据刷新后，`dd.stopPullDownRefresh`可以停止当前页面的下拉刷新。
- onShareAppMessage: 用户分享，详见[分享](https://open-doc.dingtalk.com/microapp/dev/share-app)。

##### Page.prototype.setData()

`setData`函数用于将数据从逻辑层发送到视图层，同时改变对应的`this.data`的值。

注意：

1. 直接修改`this.data`无效，无法改变页面的状态，还会造成数据不一致。
2. 请尽量避免一次设置过多的数据。

`setData`接受一个对象作为参数。对象的键名`key`可以非常灵活，以数据路径的形式给出，如 `array[2].message`、`a.b.c.d`，并且不需要在`this.data`中预先定义。

下面是示例代码。

```html
<view>{{text}}</view>
<button onTap="changeTitle"> Change normal data </button>
<view>{{array[0].text}}</view>
<button onTap="changeArray"> Change Array data </button>
<view>{{object.text}}</view>
<button onTap="changePlanetColor"> Change Object data </button>
<view>{{newField.text}}</view>
<button onTap="addNewKey"> Add new data </button>
Page({
  data: {
    text: 'test',
    array: [{text: 'a'}],
    object: {
      text: 'blue'
    }
  },
  changeTitle() {
    // 错误！不要直接去修改 data 里的数据
    // this.data.text = 'changed data'  
    
    // 正确
    this.setData({
      text: 'ha'
    })
  },
  changeArray() {
    // 可以直接使用数据路径来修改数据
    this.setData({
      'array[0].text':'b'
    })
  },
  changePlanetColor(){
    this.setData({
      'object.text': 'red'
    });
  },
  addNewKey() {
    this.setData({
      'newField.text': 'c'
    })
  }
})
```

##### Page.prototype.$spliceData()

`$spliceData`同样用于将数据从逻辑层发送到视图层，但是相比于`setData`，在处理长列表的时候，其具有更高的性能。

`$spliceData`接受一个对象作为参数。

1. 对象的键名key可以非常灵活，以数据路径的形式给出，如 `array[2].message`、`a.b.c.d`，并且不需要在`this.data`中预先定义。
2. 对象的value为一个数组（格式：[start, deleteCount, ...items]）,数组的第一个元素为操作的起始位置，第二个元素为删除的元素的个数，剩余的元素均为插入的数据。对应`es5`中数组的`splice`方法

代码示例如下：

```html
<!-- page.axml -->
<view class="spliceData">
  <view a:for="{{a.b}}" key="{{item}}" style="border:1px solid red">
    {{item}}
  </view>
</view>
// page.js
Page({
  data: {
    a: {
      b: [1,2,3,4]
    }
  },
  onLoad(){
    this.$spliceData({ 'a.b': [1, 0, 5, 6] })
  },
})
```

页面输出：

```html
1
5
6
2
3
4
```

##### getCurrentPages()

`getCurrentPages()`函数用于获取当前页面栈的实例，以数组形式按栈的顺序给出，第一个元素为首页，最后一个元素为当前页面。下面代码可以用于检测当前页面栈是否具有5层页面深度。

```js
if(getCurrentPages().length === 5) {
  dd.redirectTo({url:'/xx'});
} else {
  dd.navigateTo({url:'/xx'});
}
```

**注意：不要尝试修改页面栈，会导致路由以及页面状态错误。**

框架以栈的形式维护了当前的所有页面。 当发生路由切换的时候，页面栈的表现如下：

| 路由方式   | 页面栈表现                        |
| :--------- | :-------------------------------- |
| 初始化     | 新页面入栈                        |
| 打开新页面 | 新页面入栈                        |
| 页面重定向 | 当前页面出栈，新页面入栈          |
| 页面返回   | 当前页面出栈                      |
| Tab 切换   | 页面全部出栈，只留下新的 Tab 页面 |

##### page.json

每一个页面也可以使用`[page名].json`文件来对本页面的窗口表现进行配置。

页面的配置比`app.json`全局配置简单得多，只能设置`window`相关的配置项，所以无需写`window`这个键。注意，页面配置会覆盖`app.json`的`window`属性中的配置项。

##### page 样式

每个页面中的根元素为 page，需要设置高度或者背景色时，可以利用这个元素。

```css
page {
  background-color: #fff;
}
```

### 表单

##### Button

按钮。

扫码体验：
![componentbutton.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525402880427-b8e1a97b-fa0e-4be4-b4b7-2ecadf3d0655.png)

##### API

| 属性名           | 类型        | 默认值       | 描述                                                         | 最低版本 |
| ---------------- | ----------- | ------------ | ------------------------------------------------------------ | -------- |
| size             | String      | default      | 有效值 default, mini                                         |          |
| open-type        | String      |              | 开放能力                                                     | 1.1.0    |
| type             | String      | default      | 按钮的样式类型，有效值 primary, default, warn                |          |
| plain            | Boolean     | false        | 是否镂空                                                     |          |
| disabled         | Boolean     | false        | 是否禁用                                                     |          |
| loading          | Boolean     | false        | 按钮文字前是否带 loading 图标                                |          |
| onTap            | EventHandle |              | 点击                                                         |          |
| form-type        | String      |              | 有效值：submit, reset，用于表单组件，点击分别会触发 submit/reset 事件 |          |
| hover-class      | String      | button-hover | 按钮按下去的样式类。hover-class="none" 时表示没有点击态效果  |          |
| hover-start-time | Number      | 20           | 按住后多少时间后出现点击状态，单位毫秒                       |          |
| hover-stay-time  | Number      | 70           | 手指松开后点击状态保留时间，单位毫秒                         |          |

注：`button-hover` 默认为 `{background-color: rgba(0, 0, 0, 0.1); opacity: 0.7;}`

open-type 有效值:

| 值    | 说明                                                         | 最低版本 |
| ----- | ------------------------------------------------------------ | -------- |
| share | 触发自定义分享，可使用 canIUse('button.open-type.share') 判断 | 1.1.0    |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/xBzWvSnLypwqLLEdZmvK.png)

##### 示例

```html
<view class="page">
  <view class="section">
    <view class="title">Type</view>
    <button type="default">default</button>
    <button type="primary">primary</button>
    <button type="warn">warn</button>
  </view>
  <view class="section" style="background:#ddd;">
    <view class="title">Misc</view>
    <button type="default" plain>plain</button>
    <button type="default" disabled>disabled</button>
    <button type="default" loading={{true}}>loading</button>
    <button type="default" hover-class="red">hover-red</button>
  </view>
  <view class="section">
    <view class="title">Size</view>
    <button type="default" size="mini">mini</button>
  </view>
  <view class="section">
    <view class="title">Type</view>
    <form onSubmit="onSubmit" onReset="onReset">
      <button form-type="submit">submit</button>
      <button form-type="reset">reset</button>
    </form>
  </view>
</view>
```

#### Form

更新时间: 2018-5-4

表单，用于将组件内的用户输入的 `<textarea>`、 `<switch/>`、 `<input/>` 、`<checkbox-group/>`、`<slider/>`、`<radio-group/>`、`<picker/>` 等组件提交。

当点击 `form` 表单中 `formType` 为 `submit` 的 `button` 组件时，会将表单组件中的 `value` 值进行提交，需要在表单组件中加上 `name` 来作为 `key`。

扫码体验：
![componentform.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525402904490-1240f662-ae1d-44ab-bceb-f243d0573a43.png)

##### API

| 属性名   | 类型        | 默认值 | 描述                                                         | 最低版本 |
| -------- | ----------- | ------ | ------------------------------------------------------------ | -------- |
| onSubmit | EventHandle |        | 携带 form 中的数据触发 submit 事件，event.detail = {value : {'name': 'value'} } |          |
| onReset  | EventHandle |        | 表单重置时会触发 reset 事件                                  |          |
| class    | String      |        | 外部样式名                                                   |          |
| style    | String      |        | 内联样式                                                     |          |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/HfKjtUFGsmHraGvFnsCo.png)

##### 示例

```html
<form onSubmit="formSubmit" onReset="formReset">
  <view class="section section_gap">
    <view class="section__title">switch</view>
    <switch name="switch"/>
  </view>
  <view class="section section_gap">
    <view class="section__title">slider</view>
    <slider name="slider" show-value ></slider>
  </view>

  <view class="section">
    <view class="section__title">input</view>
    <input name="input" placeholder="please input here" />
  </view>
  <view class="section section_gap">
    <view class="section__title">radio</view>
    <radio-group name="radio-group">
      <label><radio value="radio1"/>radio1</label>
      <label><radio value="radio2"/>radio2</label>
    </radio-group>
  </view>
  <view class="section section_gap">
    <view class="section__title">checkbox</view>
    <checkbox-group name="checkbox">
      <label><checkbox value="checkbox1"/>checkbox1</label>
      <label><checkbox value="checkbox2"/>checkbox2</label>
    </checkbox-group>
  </view>
  <view class="btn-area">
    <button formType="submit">Submit</button>
    <button formType="reset">Reset</button>
  </view>
</form>
Page({
  formSubmit: function(e) {
    console.log('form发生了submit事件，携带数据为：', e.detail.value)
  },
  formReset: function() {
    console.log('form发生了reset事件')
  }
})
```

#### Label

更新时间: 2018-11-21

`Label` 可以用来改进表单组件的可用性，使用 `for` 属性找到对应组件的 `id`，或者将组件放在该标签下，当点击时，就会聚焦对应的组件。

`for` 优先级高于内部组件，内部有多个组件的时候默认触发第一个组件。

目前可以绑定的控件有：`<checkbox/>, <radio/>, <input/>, <textarea/>`

扫码体验：
![componentlabel.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525402923439-224f0fb2-b6d7-43c6-a78e-8daf2c3ab7e5.png)

##### API

| 属性名 | 类型   | 描述          |
| ------ | ------ | ------------- |
| for    | String | 绑定组件的 id |
| class  | String | 外部样式      |
| style  | String | 内联样式      |

##### 示例

```html
<view class="section">
  <view class="title">Checkbox，label 套 checkbox</view>
    <checkbox-group>
      <view>
        <label>
          <checkbox value="aaa" />
          <text>aaa</text>
        </label>
      </view>
      <view>
        <label>
          <checkbox value="bbb" />
          <text>bbb</text>
        </label>
      </view>
    </checkbox-group>
  </view>
</view>

<view class="section">
  <view class="title">Radio，通过 for 属性关联</view>
    <radio-group>
      <view>
        <radio id="aaa" value="aaa" />
        <label for="aaa">aaa</label>
      </view>
      <view>
        <radio id="bbb" value="bbb" />
        <label for="bbb">bbb</label>
      </view>
    </radio-group>
  </view>
</view>

<view class="section">
  <view class="title">多个 Checkbox</view>
    <label>
      <checkbox>选中我</checkbox>
      <checkbox>选不中</checkbox>
      <checkbox>选不中</checkbox>
      <checkbox>选不中</checkbox>
      <view>
        <text>Click Me</text>
      </view>
    </label>
  </view>
</view>
```

#### Input

更新时间: 2019-4-17

输入框。

扫码体验：
![componentinput.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525402940742-537976b5-e8ad-4532-8ad9-9971b0f93402.png)

##### API

| 属性名      | 类型        | 默认值 | 描述                                                   |
| ----------- | ----------- | ------ | ------------------------------------------------------ |
| value       | String      |        | 初始内容                                               |
| name        | String      |        | 组件名字，用于表单提交获取数据                         |
| class       | String      |        | 外部样式名                                             |
| style       | String      |        | 内联样式                                               |
| type        | String      | text   | input 的类型，有效值：text、search                     |
| password    | Boolean     | false  | 是否是密码类型                                         |
| placeholder | String      |        | 占位符                                                 |
| disabled    | Boolean     | false  | 是否禁用                                               |
| maxlength   | Number      | 140    | 最大长度                                               |
| focus       | Boolean     | false  | 获取焦点                                               |
| onInput     | EventHandle |        | 键盘输入时触发input事件，event.detail = {value: value} |
| onConfirm   | EventHandle |        | 点击键盘完成时触发，event.detail = {value: value}      |
| onFocus     | EventHandle |        | 聚焦时触发，event.detail = {value: value}              |
| onBlur      | EventHandle |        | 失去焦点时触发，event.detail = {value: value}          |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/vQYrPjIpKffmGxBmsPSE.png)

##### 示例

```html
<input placeholder="此处只有在点击下方按钮时才聚焦" focus="{{focus}}" />
<input maxlength="10" placeholder="最大输入长度10" />
<input onInput="bindKeyInput" placeholder="输入同步到view中"/>
<input password type="text" placeholder="这是一个密码输入框" />
Page({
  data: {
    focus: false,
    inputValue: '',
  },
  bindButtonTap() {
    this.setData({
      focus: true,
    });
  },
  bindKeyInput(e) {
    this.setData({
      inputValue: e.detail.value,
    });
  },
});
```

#### Textarea

更新时间: 2018-5-4

输入框。

扫码体验：
![componenttextarea.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525402963507-1f6f4a2c-99d4-4ca4-a1d6-a4c0c67aedff.png)

##### API

属性名

|             | 类型        | 默认值 | 描述                                                         |
| ----------- | ----------- | ------ | ------------------------------------------------------------ |
| name        | String      |        | 组件名字，用于表单提交获取数据                               |
| value       | String      |        | 初始内容                                                     |
| placeholder | String      |        | 占位符                                                       |
| class       | String      |        | 样式名                                                       |
| style       | String      |        | 内联样式                                                     |
| disabled    | Boolean     | false  | 是否禁用                                                     |
| maxlength   | Number      | 140    | 最大长度，当设置为-1时不限制最大长度                         |
| focus       | Boolean     | false  | 获取焦点                                                     |
| auto-height | Boolean     | false  | 是否自动增高                                                 |
| onInput     | EventHandle |        | 键盘输入时触发，event.detail = {value: value}，可以直接 return 一个字符串以替换输入框的内容 |
| onFocus     | EventHandle |        | 输入框聚焦时触发 event.detail = {value: value}               |
| onBlur      | EventHandle |        | 输入框失去焦点时触发，event.detail = {value: value}          |
| onConfirm   | EventHandle |        | 点击完成时触发，event.detail = {value: value}                |

![image](https://zos.alipayobjects.com/rmsportal/CsrhIPLDdUVmyzWcHDCr.png)

##### 示例

```html
<view class="section">
  <textarea onBlur="bindTextAreaBlur" auto-height placeholder="自动变高" />
</view>
<view class="section">
  <textarea placeholder="这个只有在按钮点击的时候才聚焦" focus="{{focus}}" />
  <view class="btn-area">
    <button onTap="bindButtonTap">使得输入框获取焦点</button>
  </view>
</view>
<view class="section">
  <form onSubmit="bindFormSubmit">
    <textarea placeholder="form 中的 textarea" name="textarea"/>
    <button form-type="submit"> 提交 </button>
  </form>
</view>
Page({
  data: {
    focus: false,
    inputValue: ''
  },
  bindButtonTap() {
    this.setData({
      focus: true
    })
  },
  bindTextAreaBlur: function(e) {
    console.log(e.detail.value)
  },
  bindFormSubmit: function(e) {
    console.log(e.detail.value.textarea)
  }
})
```

#### Radio

更新时间: 2018-5-4

##### radio-group

单项选择器组。

扫码体验：
![componentradio.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525402978424-7ea9570d-52c3-461e-a33a-31d6af062fbe.png)

##### API

| 属性名   | 类型        | 默认值 | 描述                                                         |
| -------- | ----------- | ------ | ------------------------------------------------------------ |
| onChange | EventHandle |        | 选中项发生变化时触发，event.detail = {value: 选中项radio的value} |
| name     | String      |        | 组件名字，用于表单提交获取数据                               |

##### radio

单选项目。

##### API

| 属性名   | 类型    | 默认值 | 描述                                     |
| -------- | ------- | ------ | ---------------------------------------- |
| value    | String  |        | 组件值，选中时 change 事件会携带的 value |
| checked  | Boolean | false  | 当前是否选中                             |
| disabled | Boolean | false  | 是否禁用                                 |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/YdMovutkafGtVRhZMsRm.png)

##### 示例

```html
<radio-group class="radio-group" onChange="radioChange">
  <label class="radio" a:for="{{items}}">
    <radio value="{{item.name}}" checked="{{item.checked}}"/>{{item.value}}
  </label>
</radio-group>
Page({
  data: {
    items: [
      {name: 'angular', value: 'AngularJS'},
      {name: 'react', value: 'React', checked: true},
      {name: 'polymer', value: 'Polymer'},
      {name: 'vue', value: 'Vue.js'},
      {name: 'ember', value: 'Ember.js'},
      {name: 'backbone', value: 'Backbone.js'},
    ]
  },
  radioChange: function(e) {
    console.log('你选择的框架是：', e.detail.value)
  }
})
```

#### Checkbox

更新时间: 2018-9-11

##### checkbox-group

多项选择器组。

扫码体验：
![componentcheckbox.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525403000586-40c5b60a-ee2d-497b-8e5f-04ea68ef9995.png)

##### API

| 属性名   | 类型        | 默认值 | 描述                                                         |
| -------- | ----------- | ------ | ------------------------------------------------------------ |
| name     | String      |        | 组件名字，用于表单提交获取数据                               |
| onChange | EventHandle |        | 选中项发生改变时触发，detail = {value: 选中的checkbox项value的值} |

##### checkbox

多选项目

##### API

| 属性名   | 类型        | 默认值 | 描述                                                         |
| -------- | ----------- | ------ | ------------------------------------------------------------ |
| value    | String      |        | 组件值，选中时 change 事件会携带的 value                     |
| checked  | Boolean     | false  | 当前是否选中，可用来设置默认选中                             |
| disabled | Boolean     | false  | 是否禁用                                                     |
| onChange | EventHandle |        | 组件发生改变时触发，detail = {value: 该 checkbox 是否 checked} |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/VpNrLvuCScrfwfepVAch.png)

##### 示例

```html
<checkbox-group onChange="onChange">
  <label class="checkbox" a:for="{{items}}">
    <checkbox value="{{item.name}}" checked="{{item.checked}}" disabled="{{item.disabled}}" />
    <text class="checkbox-text">{{item.value}}</text>
  </label>
</checkbox-group>
Page({
  data: {
    items: [
      {name: 'angular', value: 'AngularJS'},
      {name: 'react', value: 'React', checked: true},
      {name: 'polymer', value: 'Polymer'},
      {name: 'vue', value: 'Vue.js'},
      {name: 'ember', value: 'Ember.js'},
      {name: 'backbone', value: 'Backbone.js', disabled: true},
    ],
  },
  onChange(e) {
    dd.alert({
      title: `你选择的框架是 ${e.detail.value}`,
    });
  },
});
```

#### Switch

更新时间: 2019-4-3

扫码体验：
![componentswitch.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525403025297-812a8ad1-b1b1-4604-b915-9689460f11a9.png)

##### API

| 属性名   | 类型        | 默认值 | 描述                                              |
| -------- | ----------- | ------ | ------------------------------------------------- |
| name     | String      |        | 组件名字，用于表单提交获取数据                    |
| checked  | Boolean     |        | 是否选中                                          |
| disabled | Boolean     |        | 是否禁用                                          |
| color    | String      |        | 组件颜色                                          |
| onChange | EventHandle |        | checked 改变时触发，event.detail={ value:checked} |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/ilvTMrUIYeUIBZvCFePM.png)

##### 示例

```html
<view class="page">
  <view class="switch-list">
    <view class="switch-item">
      <switch checked onChange="switchChange"/>
    </view>
  </view>
</view>
Page({
  switchChange (e){
    console.log('switchChange 事件，值:', e.detail.value)
  },
})
```

#### Slider

更新时间: 2019-4-3

滑动选择器。

扫码体验：
![componentslider.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525403049254-5569a6de-bdbe-497d-952f-060bf1dc7904.png)

##### API

| 属性名          | 类型        | 默认值  | 描述                                              |
| --------------- | ----------- | ------- | ------------------------------------------------- |
| name            | String      |         | 组件名字，用于表单提交获取数据                    |
| min             | Number      | 0       | 最小值                                            |
| max             | Number      | 100     | 最大值                                            |
| step            | Number      | 1       | 步长，值必须大于 0，并可被(max - min)整除         |
| disabled        | Boolean     | false   | 是否禁用                                          |
| value           | Number      | 0       | 当前取值                                          |
| show-value      | Boolean     | false   | 是否显示当前 value                                |
| activeColor     | String      | #108ee9 | 已选择的颜色                                      |
| backgroundColor | String      | #ddd    | 背景条的颜色                                      |
| trackSize       | Number      | 4       | 轨道线条高度                                      |
| handleSize      | Number      | 22      | 滑块大小                                          |
| handleColor     | String      | #fff    | 滑块填充色                                        |
| onChange        | EventHandle |         | 完成一次拖动后触发，event.detail = {value: value} |

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/tbIYvqLCXYLRBBvDQngq.png)

##### 示例

```html
<view class="section section-gap">
  <text class="section-title">设置step</text>
  <view class="body-view">
    <slider value="60" onChange="sliderChange" step="5"/>
  </view>
</view>

<view class="section section-gap">
  <text class="section-title">显示当前value</text>
  <view class="body-view">
    <slider value="50" show-value/>
  </view>
</view>

<view class="section section-gap">
  <text class="section-title">设置最小/最大值</text>
  <view class="body-view">
    <slider value="100" min="50" max="200" show-value/>
  </view>
</view>

<view class="page-section">
  <view class="page-section-title">自定义样式</view>
  <view class="page-section-demo">
    <slider value="33" onChange="sliderchange" min="25" max="50" show-value
    backgroundColor="#FFAA00" activeColor="#00aaee" trackSize="2" handleSize="6" handleColor="blue" />
  </view>
</view>
Page({
  sliderChange(e) 
    console.log('slider 改变后的值:', e.detail.value)
})
```

#### Picker View

更新时间: 2018-11-21

嵌入页面的滚动选择器。

扫码体验：
![componentpicker-view.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525403068829-570d040e-8f28-49e9-b0e6-eeeeae2f71d2.png)

##### API

| 属性名         | 类型         | 默认值 | 描述                                                         |
| -------------- | ------------ | ------ | ------------------------------------------------------------ |
| value          | Number Array |        | 数字表示 picker-view-column 中对应的 index （从 0 开始）     |
| indicatorStyle | String       |        | 选中框样式                                                   |
| onChange       | EventHandle  |        | 滚动选择 value 改变时触发，event.detail = {value: value}；value为数组，表示 picker-view 内的 picker-view-column index 索引，从 0 开始 |

注意：其中只可放置组件，其他节点不会显示。该组件请勿放入 hidden 或 display none 的节点内部，需要隐藏请用 a:if 切换。
不要：

```html
<view hidden><picker-view/></view>
```

推荐：

```html
<view a:if="{{xx}}"><picker-view/></view>
```

##### Screenshot

![image](https://zos.alipayobjects.com/rmsportal/FIxLkcNKLDyWqnNnyQfX.png)

##### 示例

```html
<view class="pv-container">
  <view class="pv-left">
    <picker-view value="{{value}}" onChange="onChange">
      <picker-view-column>
        <view>2013</view>
        <view>2014</view>
      </picker-view-column>
      <picker-view-column>
        <view>春</view>
        <view>夏</view>
      </picker-view-column>
    </picker-view>
  </view>
  <view class="pv-right">
    {{value}}
  </view>
</view>
Page({
  data: {},
  onChange(e) {
    console.log(e.detail.value);
    this.setData({
      value: e.detail.value,
    });
  },
});
```

#### Picker

更新时间: 2018-9-11

从底部弹起的滚动选择器。

扫码体验：
![componentpicker.png](https://cdn-pub.yuque.com/lark/0/2018/png/106378/1525403084774-4bd48744-a30d-4ce7-a372-d9cc88b0880f.png)

| 属性名    | 类型                | 默认值 | 描述                                                         |
| :-------- | :------------------ | :----- | :----------------------------------------------------------- |
| range     | String[] / Object[] | []     | String[] 时表示可选择的字符串列表 Object[] 时需指定 range-key 表示可选择的字段 |
| range-key | String              |        | 当 range 是一个 Object[] 时，通过 range-key 来指定 Object 中 key 的值作为选择器显示内容 |
| value     | Number              |        | 表示选择了 range 中的第几个（下标从 0 开始）                 |
| onChange  | EventHandle         |        | value 改变时触发，event.detail = {value: value}              |
| disabled  | Boolean             | false  | 是否禁用                                                     |

##### Screenshot

![image](https://gw.alipayobjects.com/zos/rmsportal/rKPwHCZyObmhCXASjixS.png)

##### 示例

```html
<view class="section">
  <view class="section-title">地区选择器</view>
  <picker onChange="bindPickerChange" value="{{index}}" range="{{array}}">
    <view class="picker">
      当前选择：{{array[index]}}
    </view>
  </picker>
  
  <picker onChange="bindObjPickerChange" value="{{arrIndex}}" range="{{objectArray}}" range-key="name">
    <view class="row">
      <view class="row-title">ObjectArray</view>
      <view class="row-extra">当前选择：{{objectArray[arrIndex].name}}</view>
      <image class="row-arrow" src="/image/arrowright.png" mode="aspectFill" />
    </view>
  </picker>
</view>
Page({
  data: {
    array: ['中国', '美国', '巴西', '日本'],
    objectArray: [
      {
        id: 0,
        name: '美国',
      },
      {
        id: 1,
        name: '中国',
      },
      {
        id: 2,
        name: '巴西',
      },
      {
        id: 3,
        name: '日本',
      },
    ],
    arrIndex: 0,
    index: 0
  },
  bindPickerChange(e) {
    console.log('picker发送选择改变，携带值为', e.detail.value);
    this.setData({
      index: e.detail.value,
    });
  },
  bindObjPickerChange(e) {
    console.log('picker发送选择改变，携带值为', e.detail.value);
    this.setData({
      arrIndex: e.detail.value,
    });
  },
});
```